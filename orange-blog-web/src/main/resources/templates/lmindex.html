<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<html>
  <head>
    <meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="referrer" content="never">
    <meta name="keywords" content="">
	<meta name="description" content="" />
	<link th:href="@{/css/carousel.css}" rel="styleSheet" type="text/css"/>
	<link th:href="@{/css/cikonss.css}" rel="styleSheet" type="text/css"/>
    <link th:href="@{/css/iconfont.css}" rel="styleSheet" type="text/css"/>
    <link th:href="@{/css/common.css}" rel="styleSheet" type="text/css"/>
    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet" type="text/css"/>
    <link rel="shortcut icon" type="image/x-iccnpmon" th:href="@{/image/favicon.ico}">
    <script th:src="@{/js/jquery-3.3.1.min.js}"></script>
    <script th:src="@{/js/lm.js}"></script>
    <script th:src="@{/js/bootstrap.min.js}" ></script>
    <script th:src="@{/js/echo.min.js}" ></script>
	<script>window.jQuery || document.write('<script th:src="@{/js/jquery-3.3.1.min.js}"><\/script>')</script>
    <title>lmorange</title>
  </head>
  <style type="text/css">
    .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
      }
    @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    .my-sm-0:hover{
        background-color:orange;
     }
    .imghover{
        cursor: pointer;
        transition: all 0.5s;
     }
    .imghover:hover{
        transform: scale(1.05);
     }
    .load_div{
        padding: 5px 0;
        text-align:center;
        cursor: pointer;
     }
    .load_active{
        display:block;
     }
    .load_no_active{
        display:none;
     }
    .blog_head{
         cursor: pointer;
     }

  </style>
  <body>
  <header>
    <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark" style="background:linear-gradient(to bottom right,#3B7B9A, #0085c5, #00141d, #A5DEF1)!important">
      <a class="navbar-brand" href="/index/indexBlogs"><span>首页</span></a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link disabled" href="#">橙子的个人生活</a>
          </li>
          <li class="nav-item">
            <a class="nav-link " href="/index/indexBlogs?parentCategoryId=lz">栗子生活</a>
          </li>
          <li class="nav-item">
            <a class="nav-link " href="/index/indexBlogs?parentCategoryId=back">Java</a>
          </li>
        </ul>
        <form class="form-inline mt-2 mt-md-0">
          <input class="form-control mr-sm-2" type="text" placeholder="开发ing、请期待" aria-label="Search">
          <button class="btn btn-outline-success my-2 my-sm-0" type="submit" style="color:#fff;border-color:orange;">Search</button>
        </form>
      </div>
    </nav>
  </header>
<canvas id="bubbles" ></canvas>
<main role="main">

  <div id="myCarousel" class="carousel slide" style="margin-bottom:2em;">
    <ol class="carousel-indicators">
      <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
      <li data-target="#myCarousel" data-slide-to="1"></li>
      <li data-target="#myCarousel" data-slide-to="2"></li>
    </ol>
    <div class="carousel-inner">
      <div class="carousel-item active">
        <img class="img-carousel" th:src="@{/image/bg1.jpg}" />
        <div class="container">			
          <div class="carousel-caption text-left">
            <h1>示例1号</h1>
            <p>内容未知.</p>
          </div>
        </div>
      </div>
      <div class="carousel-item">
        <img class="img-carousel" th:src="@{/image/bg2.jpg}" />
        <div class="container">
          <div class="carousel-caption">
            <h1>实例二号</h1>
            <p>内容未知.</p>
          </div>
        </div>
      </div>
      <div class="carousel-item">
        <img class="img-carousel" th:src="@{/image/bg3.jpg}" />
        <div class="container">
          <div class="carousel-caption text-right">
            <h1>还有一个示例</h1>
            <p>内容未知.</p>
          </div>
        </div>
      </div>
    </div>
    <a class="carousel-control-prev" href="#myCarousel" role="button" data-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="sr-only">Previous</span>
    </a>
    <a class="carousel-control-next" href="#myCarousel" role="button" data-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="sr-only">Next</span>
    </a>
  </div>
  <div class="container marketing" style="background:#fff;">
      <input class="featurette inp_display" value="0"/>
  </div>
  <!-- FOOTER -->
  <footer class="footer_div">
    <!-- 加载loading -->
    <div id="load_div1" class="load_div load_no_active">
      <image th:src="@{/image/loading0.gif}" />
    </div>
    <!-- click加载loading -->
    <div id="load_div2" class="load_div load_active" th:onclick="'clickLoading()'">
      <input id="pageIndex_inp" value="1" style="display:none;"/>
      <span class="iconfont icon-zhankai5" style="font-size:2rem; color:#777"></span>
    </div>
    <!-- 已经加载到最后 -->
    <div id="load_div3" class="load_div load_no_active">
      <span style="color:#777;">已经没有可加载的了...</span>
    </div>
    <div class="float-right-p">
      <button type="button" class="btn btn-link float-btn"><div style="width:44px;height:44px;background: url(/image/zonghelogo.png) -68px -24px no-repeat;"></div></button>
      <!--<button type="button" class="btn btn-link float-btn"><div style="width:44px;height:44px;background: url(/image/zonghelogo.png) -318px -24px no-repeat;"></div></button>-->
      <button type="button" class="btn btn-link float-btn"><div style="width:44px;height:44px;background: url(/image/zonghelogo.png) -484px -24px no-repeat;"></div></button>
      <!--<button type="button" class="btn btn-link float-btn"><div style="width:44px;height:44px;background: url(/image/zonghelogo.png) -234px -24px no-repeat;"></div></button>-->
      <button type="button" class="btn btn-link float-btn" style="text-decoration:none;"><span id="toTop" onclick="backToTop()"  class="iconfont icon-icon-test back-to-top"></span></button>
    </div>
  </footer>
  <div class="p_center">
    <ul>
      <li>&copy; 2019 LmOrange 蜀ICP备19015312号</li>
    </ul>
    <ul>
      <li>
        <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
         document.write(unescape("%3Cspan id='cnzz_stat_icon_1277763152'%3E%3C/span%3E%3Cscript src='" +
         cnzz_protocol + "s23.cnzz.com/z_stat.php%3Fid%3D1277763152%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"));</script>
      </li>
    </ul>
    <ul>
      <li>友情链接：</li>
      <li><a href="https://www.baidu.com" target="_blank">百度</a></li>
      <li>阿里云</li>
      <li>淘宝</li>
      <li>凤凰网</li>
    </ul>
  </div>
</main>
</body>
<script type="text/javascript" th:src="@{/js/canvas-bubbles.js}"></script>
<script type="text/javascript" th:inline="javascript">
    var categoryId = "";
    var parentCategoryId = "";
	$(document).ready(function(){
		$("#myCarousel").carousel('pause');
        $("#load_div1").removeClass('load_no_active');
        $("#load_div1").addClass('load_active');
        $("#load_div2").removeClass('load_active');
        $("#load_div2").addClass('load_no_active');
        var obj = getRequest();
        categoryId = obj.categoryId;
        parentCategoryId = obj.parentCategoryId;
        queryMoreImageBlogs();
        // 图片懒加载
        echo.init({
            offset: 0,
            throttle: 250,
        });
	});
	// 解析url后面的参数
    function getRequest(){
        var url = window.location.search;
        var theRequest = new Object();
        if(url.indexOf("?") != -1){
            var str = url.substr(1);
            var strs = str.split("&");
            for(var i = 0; i < strs.length; i ++) {
                theRequest[strs[i].split("=")[0]]=unescape(strs[i].split("=")[1]);
            }
        }
        return theRequest;
    }
    // 回到顶部
    function backToTop(){
        $('body,html').animate({scrollTop:0},500);
    }
	// 获取页面被卷起来的高度
	function scrollTop(){
		return Math.max(
		//chrome
		document.body.scrollTop,
		//firefox/IE
		document.documentElement.scrollTop);
	}
	// 获取页面文档的总高度
	function documentHeight(){
		//现代浏览器（IE9+和其他浏览器）和IE8的document.body.scrollHeight和document.documentElement.scrollHeight都可以
		return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);
	}
	// 获取页面浏览器的视口的高度
	function windowHeight(){
		//document.compatMode有两个取值。BackCompat：标准兼容模式关闭。CSS1Compat：标准兼容模式开启。
		return (document.compatMode == "CSS1Compat")?document.documentElement.clientHeight:document.body.clientHeight;
	}
	// 监听事件
	//$(window).on('scroll', function(){
		//console.log("各个高度" + scrollTop() +"和"+ windowHeight() +"和"+ documentHeight());
		//if(scrollTop() + windowHeight() >= (documentHeight() + 50)){
			//$("#load_div").addClass('load_active');
			//setTimeout('loadingData()',1000);
		//}
	//});
	// 加载数据
	function loadingData(obj){
        var index = $(".inp_display:last").val();
        if(evenOrOdd(index)){
            evenData(obj, index);
        }else{
            oddData(obj, index);
        }
		$("#load_div1").removeClass('load_active');
		$("#load_div1").addClass('load_no_active');
		$("#load_div2").removeClass('load_no_active');
		$("#load_div2").addClass('load_active');
	}

	// 偶数行数据
	var evenData = function(obj, index){
        $(".featurette:last").after("<div class='row featurette shadow p-3 mb-5 bg-white rounded' >"+
            "<input value='"+ ((+index) + 1) +"' class='inp_display'/>" +
            "<div class='col-md-7'>"+
            "<h2 class='featurette-heading blog_head' onclick='clickBlog(\"" + obj.id + "\")'><span class='iconfont icon-zhiding1'></span>"+ obj.title +"</h2>"+
            "<div class='badge_padding badge_tag'>"+
            "<span class='badge badge-light'>" + obj.sCt + "</span>"+
            "<span class='badge badge-light'>"+ obj.authorName +"</span>"+
            "<span class='badge badge-primary iconfont icon-06tags'>&nbsp"+ obj.parentCategoryName +"</span>"+
            "<span class='badge badge-pill badge-info iconfont icon-tag-o'>&nbsp"+ obj.categoryName +"</span>"+
            "</div>"+
            "<p class='lead'>"+ obj.outline +"</p>"+
            "<div class='mg_bottom float-right' >" +
            "<span class='iconfont icon-eye2 float-right'><p class='p-record'>"+ obj.blogView +"</p></span>" +
            "<span class='iconfont icon-xihuan4 float-right'><p class='p-record'>"+ obj.praiseNum +"</p></span>" +
            "</div>"+            "</div>"+
            "<div class='col-md-5 imghover' onclick='clickBlog(\"" + obj.id + "\")'>"+
            "<div class='img_padding0'>"+
            "<img src='/image/loading7.gif' data-echo=\"" + obj.imageUrl + "\" alt=\"" + obj.imageUrl + "\" class='img-fluid0 lm-shadow0' >"+
            "</div>"+
            "</div>"+
            "</div>");
    }

    // 奇数行数据
    var oddData = function(obj, index){
        $(".featurette:last").after("<div class='row featurette shadow p-3 mb-5 bg-white rounded' >"+
            "<input value='"+ ((+index) + 1) +"' class='inp_display'/>" +
            "<div class='col-md-7 order-md-2'>"+
            "<h2 class='featurette-heading blog_head' onclick='clickBlog(\"" + obj.id + "\")'><span class='iconfont icon-zhiding1'></span>"+ obj.title +"</h2>"+
            "<div class='badge_padding badge_tag'>"+
            "<span class='badge badge-light'>" + obj.sCt + "</span>"+
            "<span class='badge badge-light'>"+ obj.authorName +"</span>"+
            "<span class='badge badge-primary iconfont icon-06tags'>&nbsp"+ obj.parentCategoryName +"</span>"+
            "<span class='badge badge-pill badge-info iconfont icon-tag-o'>&nbsp"+ obj.categoryName +"</span>"+
            "</div>"+
            "<p class='lead'>"+ obj.outline +"</p>"+
            "<div class='mg_bottom float-right' >" +
            "<span class='iconfont icon-eye2 float-right'><p class='p-record'>"+ obj.blogView +"</p></span>" +
            "<span class='iconfont icon-xihuan4 float-right'><p class='p-record'>"+ obj.praiseNum +"</p></span>" +
            "</div>"+
            "</div>"+
            "<div class='col-md-5 order-md-1 imghover' onclick='clickBlog(\"" + obj.id + "\")'>"+
            "<div class='img_padding0'>"+
            "<img src='/image/loading7.gif' data-echo=\"" + obj.imageUrl + "\" alt=\"" + obj.imageUrl + "\" class='img-fluid0 lm-shadow0' >"+
            "</div>"+
            "</div>"+
            "</div>");
    }

	// 点击加载
	function clickLoading(){
		$("#load_div1").removeClass('load_no_active');
		$("#load_div1").addClass('load_active');
		$("#load_div2").removeClass('load_active');
		$("#load_div2").addClass('load_no_active');
		// setTimeout('queryMoreImageBlogs()',1000);
        queryMoreImageBlogs()
	}
    // 判断是奇数还是偶数
    function evenOrOdd(index){
        return (index%2 == 0) ? false : true;
    }
    // 点击博客跳转
    function clickBlog(blogId){
        window.open("/blog/blogDetail/"+blogId, "陈康博客")
    }
    // 重新查询
    function queryImageBlogs(type, value){
        $(".rounded").remove();
        $("#load_div3").addClass('load_no_active');
        $("#load_div3").removeClass('load_active');
        $("#load_div2").addClass('load_no_active');
        $("#load_div2").removeClass('load_active');
        $("#pageIndex_inp").val("1");
        imageBlogMore(type, value, $("#pageIndex_inp").val());
    }
    // 查询更多
    function queryMoreImageBlogs(type, value){
        var pageIndex = $("#pageIndex_inp").val();
        imageBlogMore(type, value, pageIndex);
    }
    // 得到更多
    function imageBlogMore(type, value, pageIndex){
        switch (type){
            case "1": parentCategoryId = value;break;
            case "2": categoryId = value;break;
        }
        var param = JSON.stringify({"categoryId":categoryId, "parentCategoryId":parentCategoryId, "pageIndex":pageIndex, "pageSize":10});
        $.ajax({
            type:"POST",
            dataType:"json",
            url:"/index/indexBlogsMore",
            data: param,
            contentType: "application/json",
            success:function(data){
                var obj = data.data;
                if(!$.isEmptyObject(data) && obj.length > 0){
                    for(var i=0; i< obj.length; i++){
                        loadingData(obj[i]);
                    }
                    pageIndex = (+pageIndex) + 1;
                    $("#pageIndex_inp").val(pageIndex);
                }else{
                    $("#load_div1").removeClass('load_active');
                    $("#load_div1").addClass('load_no_active');
                    $("#load_div3").removeClass('load_no_active');
                    $("#load_div3").addClass('load_active');
                }
            }
        });
    }
    // 时间格式化处理
    function dateFormat(d){
        var date= new Date(Date.parse(d));
        var fmt = "yyyy年MM月dd日 hh:mm:ss";
        var o = {
            'M+': date.getMonth() + 1, //月份
            'd+': date.getDate(), //日
            'h+': date.getHours(), //小时
            'm+': date.getMinutes(), //分
            's+': date.getSeconds(), //秒
            'q+': Math.floor((date.getMonth() + 3) / 3), //季度
            'S': date.getMilliseconds() //毫秒
        };
        if(!isNotEmpty(fmt)){
            fmt = 'yyyy-MM-dd hh:mm:ss';
        }
        if (/(y+)/.test(fmt)) {
            fmt = fmt.replace(RegExp.$1, (date.getFullYear() + '').substr(4 - RegExp.$1.length));
        }
        for (var k in o) {
            if (new RegExp('(' + k + ')').test(fmt)) {
                fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (('00' + o[k]).substr(('' + o[k]).length)));
            }
        }
        return fmt;
    }

    /**
     * 是否为空
     * @param str
     * @returns {boolean}
     */
    function isNotEmpty(str) {
        if (str != '' && str != null && typeof str != 'undefined') {
            return true;
        }
        console.warn('argument format is wrong');
        return false;
    }
</script>
</html>
